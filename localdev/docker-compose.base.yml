version: '2.4'

#
# Do not try to run this manually. This is meant to be run using the runLocal.sh script in the root of the project.
# Also do not edit docker-compose.yml as it is autogenerated.
# If you make any changes to this file remember to run "./runLocal.sh refresh".
#

#
# Network definitions
#
networks:
  demoapp:


services:
  #
  # Database
  #
  postgresql-server:
    image: postgres:15-alpine
    container_name: demoapp-postgresql-server
    ports:
      - "5432:5432"
    environment:
      - "POSTGRES_PASSWORD=7b1c3deda5144f99a6973f462215b8cd"
    volumes:
      - ./app-config/postgresql-initdb.d:/docker-entrypoint-initdb.d:ro
    networks:
      - demoapp

  #
  # Redis
  #
  redis-server:
    image: redis:7-alpine
    container_name: demoapp-redis-server
    ports:
      - "6379:6379"
    networks:
      - demoapp

  #
  # pgweb (simple ui for postgresql)
  #
  pgweb:
    image: sosedoff/pgweb
    container_name: demoapp-pgweb
    restart: always
    ports:
      - "54321:8081"
    environment:
      - "DATABASE_URL=postgres://postgres:7b1c3deda5144f99a6973f462215b8cd@postgresql-server:5432/postgres?sslmode=disable"
    links:
      - postgresql-server:postgresql-server
    depends_on:
      - postgresql-server
    networks:
      - demoapp

